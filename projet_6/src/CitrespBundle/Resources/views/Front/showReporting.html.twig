{# src/CitrespBundle/Resources/views/Front/showReporting.html.twig #}

{% extends '@Citresp/layout.html.twig' %}

{% block stylesheets %}
  {{ parent() }}

  <style>

    #map {
      min-height: 26.25rem;

    }
  </style>
{% endblock %}

{% block header %}
  {% embed "@Citresp/cityMapHeader.html.twig" %}{% endembed %}
{% endblock %}

{% block body %}
  <div class="container text-center">

    <h2>{{ reporting.category.name }}</h2>

    <h4>{{ reporting.address }}</h4>
    <p class="text-muted">
      <strong>{{ reporting.user }}</strong>
      le
      {{ reporting.dateCreated|localizeddate('none', 'none', null, null, 'EEEE d MMMM Y') }}
    </p>

    <p>{{ reporting.description }}</p>

    <hr>
    {% for comment in comments %}
      <p class="text-muted">

        le
        {{ comment.dateCreated|localizeddate('none', 'none', null, null, 'EEEE d MMMM Y') }}
      </p>
      <p>{{ comment.content }}</p>

    {% endfor %}

  </div>

{% endblock %}

{% block javascripts %}
  {{ parent() }}
  <script>
    var map;
    function initMap() {
      var city = {
        lat: {{ city.gpsLat }},
        lng: {{ city.gpsLng }}
      };
      var coorMarker = {
        lat: {{ reporting.gpsLat }},
        lng: {{ reporting.gpsLng }}
      };
      map = new google.maps.Map(document.getElementById('map'), {
        zoom: 20,
        center: coorMarker
      });

      var marker = new google.maps.Marker({position: coorMarker, map: map});
    }
  </script>
  <script src="https://maps.googleapis.com/maps/api/js?key={{googleApi}}&callback=initMap" async="async" defer="defer"></script>
{% endblock %}
